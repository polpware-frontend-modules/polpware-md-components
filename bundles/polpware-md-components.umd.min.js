!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/cdk/collections"),require("showdown"),require("rxjs"),require("@angular/cdk/coercion"),require("@angular/common/http"),require("@polpware/fe-utilities"),require("@angular/core"),require("@angular/common"),require("@angular/material"),require("@angular/forms"),require("ngx-chips")):"function"==typeof define&&define.amd?define("@polpware/md-components",["exports","@angular/cdk/collections","showdown","rxjs","@angular/cdk/coercion","@angular/common/http","@polpware/fe-utilities","@angular/core","@angular/common","@angular/material","@angular/forms","ngx-chips"],t):t((e.polpware=e.polpware||{},e.polpware["md-components"]={}),e.ng.cdk.collections,e.showdown,e.rxjs,e.ng.cdk.coercion,e.ng.common.http,e.feUtilities,e.ng.core,e.ng.common,e.ng.material,e.ng.forms,e.ngxChips)}(this,function(e,t,i,o,n,r,a,s,l,u,c,d){"use strict";var p=function(e,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function m(e,t){function n(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var f=function(n){function e(e){var t=n.call(this)||this;return t._database=e,t._filterChange=new o.BehaviorSubject(""),t}return m(e,n),Object.defineProperty(e.prototype,"filter",{get:function(){return this._filterChange.value},set:function(e){this._filterChange.next(e)},enumerable:!0,configurable:!0}),e.prototype.connect=function(){return this._database.dataChange.asObservable()},e.prototype.disconnect=function(){},e}(t.DataSource),g=function(){function e(e,t){this.dialogRef=e,this.data=t,this.title=t.title||""}return e.prototype.onNoClick=function(){this.dialogRef.close()},e.decorators=[{type:s.Component,args:[{selector:"polp-md-indicator-modal",template:'<div class="full-width flex-box flex-column align-items-center">\r\n  <mat-spinner>\r\n  </mat-spinner>\r\n  <h3>{{title}}</h3>\r\n</div>\r\n\r\n'}]}],e.ctorParameters=function(){return[{type:u.MatDialogRef},{type:undefined,decorators:[{type:s.Inject,args:[u.MAT_DIALOG_DATA]}]}]},e}(),h=function(){function e(e){this._dialog=e,this._showingTimer=null,this._showingDelay=500,this._dismissingTimer=null,this._diaglogRef=null,this._counter=0}return e.prototype.setDelay=function(e){this._showingDelay=1e3*e},e.prototype.show=function(e){var t=this;if(void 0===e&&(e="Loading ..."),this._counter++,!this._diaglogRef)return this._dismissingTimer?(clearTimeout(this._dismissingTimer),void(this._dismissingTimer=0)):void(this._showingTimer||(this._showingTimer=setTimeout(function(){t._showingTimer=null,t._diaglogRef=t._dialog.open(g,{width:"250px",data:{title:e}})},this._showingDelay)));this._dismissingTimer&&(clearTimeout(this._dismissingTimer),this._dismissingTimer=0)},e.prototype.hide=function(){var e=this;if(this._counter--,!(0<this._counter))return this._showingTimer?(clearTimeout(this._showingTimer),void(this._showingTimer=null)):this._dismissingTimer?(clearTimeout(this._dismissingTimer),void(this._dismissingTimer=setTimeout(function(){e._dismissingTimer=null,e._diaglogRef&&(e._diaglogRef.close(),e._diaglogRef=null)},300))):void(this._diaglogRef&&(this._dismissingTimer=setTimeout(function(){e._diaglogRef&&(e._diaglogRef.close(),e._diaglogRef=null)},300)))},e.decorators=[{type:s.Injectable}],e.ctorParameters=function(){return[{type:u.MatDialog}]},e}();function y(e){var t=e.value;return/\S+@\S+\.\S+/.test(t)?null:{isValidEmail:!0}}var b=/[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*/g;function v(e){for(var t,n=[],o=0;t=b.exec(e);){var i;(i=e.substring(o,t.index).replace(/(^[\s,>]+)|"|([\s,<]+$)/g,""))?n.push('"'+i+'" <'+t[0]+">"):n.push(t[0]),o=t.index+t[0].length}return n}function _(e){for(var t,n=[];t=b.exec(e);)n.push(t[0]);return n}var x=function(){function e(e){this.dialogRef=e,this.validators=[y],this.errorMessages={isValidEmail:"Please input a valid email"},this.title="Send out an email",this.emails=[],this.messageBody="",this.disableFocusEvent=!1}return Object.defineProperty(e.prototype,"isSubmitDisabled",{get:function(){return 0===this.emails.length},enumerable:!0,configurable:!0}),e.prototype.onOutOfTagInput=function(e){var t=this;this.disableFocusEvent||(e.preventDefault(),e.stopPropagation(),v(this.emailInputBox.formValue).forEach(function(e){t.emails.push(e)}),this.emailInputBox.setInputValue(""),this.disableFocusEvent=!0,this.emailBody.nativeElement.focus(),this.disableFocusEvent=!1)},e.propDecorators={emailInputBox:[{type:s.ViewChild,args:["emailInputBox"]}],emailBody:[{type:s.ViewChild,args:["emailBody"]}]},e}(),T=function(o){function e(e,t){var n=o.call(this,e)||this;return n.dialogRef=e,n.data=t,n.messageBody=t.emailBody||"",n}return m(e,o),Object.defineProperty(e.prototype,"isSubmitDisabled",{get:function(){return 0===this.emails.length},enumerable:!0,configurable:!0}),e.prototype.onSubmit=function(){var e=this.messageBody;e=(new i.Converter).makeHtml(e);var t=[];this.emails.forEach(function(e){_(e||e.value).forEach(function(e){t.push(e)})});var n={confirmed:!0,emailReceivers:t,emailBody:e,emailTitle:this.data.emailTitle||""};this.dialogRef.close(n)},e.decorators=[{type:s.Component,args:[{selector:"polp-md-email-form",template:'<h2 mat-dialog-title>\r\n    {{title}}\r\n    <button class="float-right"\r\n            mat-icon-button\r\n            tabIndex="-1"\r\n            [mat-dialog-close]="true">\r\n        <mat-icon>close</mat-icon>\r\n    </button>\r\n</h2>\r\n\r\n<mat-dialog-content>\r\n\r\n    <form name="emailForm" autocomplete="off">\r\n        <div class="flex-box flex-column margin-bottom-15">\r\n            <tag-input [(ngModel)]="emails" #emailInputBox\r\n                       name="emailInputs"\r\n                       [addOnPaste]="true"\r\n                       [modelAsStrings]="true"\r\n                       [trimTags]="true"\r\n                       [editable]="true"\r\n                       (focusout)="onOutOfTagInput($event)"\r\n                       [errorMessages]="errorMessages"\r\n                       [validators]="validators"\r\n                       [secondaryPlaceholder]="\'Emails\'"\r\n                       [separatorKeyCodes]="[32,44,58,59]"\r\n                       [placeholder]="\'More Emails\'">\r\n            </tag-input>\r\n\r\n            <div class="full-width">\r\n                <textarea name="messageBody"\r\n                          matInput\r\n                          #emailBody\r\n                          cdkTextareaAutosize\r\n                          cdkAutosizeMinRows="2"\r\n                          cdkAutosizeMaxRows="5"                      \r\n                          placeholder="Type your personal message here"\r\n                          [(ngModel)]="messageBody">\r\n                </textarea>\r\n            </div>\r\n\r\n        </div>\r\n    </form>\r\n\r\n</mat-dialog-content>\r\n\r\n<mat-dialog-actions>\r\n    <button mat-flat-button\r\n            color="primary"\r\n            [disabled]="isSubmitDisabled"\r\n            (click)="onSubmit()">\r\n        Send\r\n    </button>\r\n</mat-dialog-actions>\r\n'}]}],e.ctorParameters=function(){return[{type:u.MatDialogRef},{type:undefined,decorators:[{type:s.Inject,args:[u.MAT_DIALOG_DATA]}]}]},e}(x),M=function(){function e(){this.stateChanges=new o.Subject,this.id="radio-group-field-control-"+e.nextId++,this.focused=!1,this.errorState=!1,this.controlType="radio-group-field",this.describedBy="",this.ngControl=null}return Object.defineProperty(e.prototype,"value",{get:function(){return this.radioGroup.value},set:function(e){this.radioGroup.value=e,this.stateChanges.next()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"placeholder",{get:function(){return this._placeholder},set:function(e){this._placeholder=e,this.stateChanges.next()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldLabelFloat",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"required",{get:function(){return this.radioGroup.required},set:function(e){this.radioGroup.required=n.coerceBooleanProperty(e),this.stateChanges.next()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this.radioGroup.disabled},set:function(e){this.radioGroup.disabled=n.coerceBooleanProperty(e),this.stateChanges.next()},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.ngOnDestroy=function(){this.stateChanges.complete()},e.prototype.setDescribedByIds=function(e){this.describedBy=e.join(" ")},e.prototype.onContainerClick=function(e){},e.prototype.writeValue=function(e){e!==undefined&&this.radioGroup.writeValue(e)},e.prototype.registerOnChange=function(e){this.radioGroup.registerOnChange(e)},e.prototype.registerOnTouched=function(e){this.radioGroup.registerOnTouched(e)},e.nextId=0,e.decorators=[{type:s.Component,args:[{selector:"polp-radio-group-field",template:'<mat-radio-group>\n    <mat-radio-button *ngFor="let item of radioOptions" value="{{item.value}}">{{item.text}}</mat-radio-button>\n</mat-radio-group>\n',providers:[{provide:u.MatFormFieldControl,useExisting:e},{provide:c.NG_VALUE_ACCESSOR,multi:!0,useExisting:s.forwardRef(function(){return e})}],styles:[".mat-radio-group .mat-radio-button{margin:0 5px}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={radioGroup:[{type:s.ViewChild,args:[u.MatRadioGroup]}],id:[{type:s.HostBinding}],describedBy:[{type:s.HostBinding,args:["attr.aria-describedby"]}],radioOptions:[{type:s.Input}],value:[{type:s.Input}],placeholder:[{type:s.Input}],shouldLabelFloat:[{type:s.HostBinding,args:["class.floating"]}],required:[{type:s.Input}],disabled:[{type:s.Input}]},e}(),C=function(){function e(e,t){this.dialogRef=e,this.data=t,this.files=[],this.responses=[],this.title=this.data.title||"",this.accept=this.data.accept||"*/",this.text=this.data.prelude||"",this.mode=this.data.progressMode||"indeterminate"}return Object.defineProperty(e.prototype,"isCloseDisabled",{get:function(){return this.files.some(function(e){return e.inProgress})},enumerable:!0,configurable:!0}),e.prototype.close=function(){this.dialogRef.close(this.responses)},e.prototype.ngOnInit=function(){},e.prototype.startUpload=function(){var o=this,i=document.getElementById("polpFileUpload");i.onchange=function(){var e=o.data.validateInput(i.files);if(e)o.error=e;else{for(var t=0;t<i.files.length;t++){var n=i.files[t];o.files.push({uuid:a.guid(),data:n,state:"in",inProgress:!1,progress:0,canRetry:!1,canCancel:!0,message:""})}o.uploadFiles()}},i.click()},e.prototype.cancelFile=function(e){e.sub.unsubscribe(),this.removeFileFromArray(e)},e.prototype.retryFile=function(e){this.uploadFile(e),e.canRetry=!1},e.prototype.postUploadFile=function(e,t){var n=this;this.responses.push({uuid:e.uuid,body:t}),this.data.closeOnSunccess&&this.files.length===this.responses.length&&setTimeout(function(){n.close()})},e.prototype.uploadFile=function(t){var n=this;t.inProgress=!0,t.sub=this.data.uploadService.upload(t.data,this.data.uploadUrl,this.data.makeFormData).subscribe(function(e){switch(e.eventType){case r.HttpEventType.UploadProgress:t.progress=e.percent;break;case r.HttpEventType.Response:t.message="Upload Ok.",t.inProgress=!1,t.canCancel=!1,t.canRetry=!1,n.postUploadFile(t,e.body)}},function(e){t.inProgress=!1,t.canRetry=!0,t.message="upload failure."})},e.prototype.uploadFiles=function(){var t=this;document.getElementById("polpFileUpload").value="",this.files.forEach(function(e){t.uploadFile(e)})},e.prototype.removeFileFromArray=function(e){var t=this.files.indexOf(e);-1<t&&this.files.splice(t,1)},e.decorators=[{type:s.Component,args:[{selector:"plop-upload-file",template:'<h2 mat-dialog-title>\n    {{title}}\n    <button class="float-right"\n            mat-icon-button\n            tabIndex="-1"\n            [disabled]="isCloseDisabled"            \n            [mat-dialog-close]="true">\n        <mat-icon>close</mat-icon>\n    </button>\n</h2>\n\n<mat-dialog-content>\n\n    <div class="flex-box flex-column">\n\n        <button mat-flat-button color="accent" (click)="startUpload()">\n            <mat-icon>file_upload</mat-icon>\n            {{text}}\n        </button>\n\n        <p *ngIf="error" color="warn">{{error}}</p>\n        \n        <mat-list>\n            <mat-list-item *ngFor="let file of files">\n                <mat-progress-bar matLine *ngIf="file.inProgress"\n                                  [value]="file.progress" mode="{{mode}}">\n                </mat-progress-bar>\n                <div matLine>\n                    <span>\n                        {{file.data.name}}\n                    </span>\n                    \n                    <span>\n                        {{file.data.message}}\n                    </span>\n                    \n                    <button mat-icon-button title="Retry" (click)="retryFile(file)" *ngIf="file.canRetry">\n                        <mat-icon>refresh</mat-icon>\n                    </button>\n                    <button mat-icon-button title="Cancel" (click)="cancelFile(file)" *ngIf="file.canCancel">\n                        <mat-icon>cancel</mat-icon>\n                    </button>\n                </div>\n            </mat-list-item>\n        </mat-list>\n\n    </div>    \n    \n    <input type="file" id="polpFileUpload" name="fileUpload" multiple="multiple" accept="{{accept}}" style="display:none;"/>\n    \n</mat-dialog-content>\n\n<mat-dialog-actions>\n    <button mat-flat-button\n            [disabled]="isCloseDisabled"\n            (click)="close()">\n        Close\n    </button>\n</mat-dialog-actions>\n',styles:[""]}]}],e.ctorParameters=function(){return[{type:u.MatDialogRef},{type:undefined,decorators:[{type:s.Inject,args:[u.MAT_DIALOG_DATA]}]}]},e}(),w=function(){function e(e){if(e)throw new Error("PolpMdComponentsModule is already loaded. Import it in the AppModule only")}return e.forRoot=function(){return{ngModule:e}},e.decorators=[{type:s.NgModule,args:[{declarations:[g,T,M,C],imports:[l.CommonModule,c.FormsModule,c.ReactiveFormsModule,u.MatProgressSpinnerModule,u.MatDialogModule,u.MatButtonModule,u.MatIconModule,u.MatRadioModule,u.MatProgressBarModule,u.MatListModule,d.TagInputModule],exports:[g,T,M,C],entryComponents:[g,T,C],providers:[h]}]}],e.ctorParameters=function(){return[{type:e,decorators:[{type:s.Optional},{type:s.SkipSelf}]}]},e}();e.TableDataSourceAdaptor=f,e.PolpMdIndicatorModal=g,e.PolpMdSpinnerServiceImpl=h,e.parseEmails=v,e.parseOnlyEmails=_,e.EmailFormAbstractComponent=x,e.EmailFormComponent=T,e.RadioGroupFieldControl=M,e.UploadFileComponent=C,e.PolpMdComponentsModule=w,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=polpware-md-components.umd.min.js.map